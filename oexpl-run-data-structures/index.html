<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Compiler Lab website for NIT Calicut"><link href=https://silcnitc.github.io/expl-docs/oexpl-run-data-structures/ rel=canonical><link href=../oexpl_data_structures/class-table/ rel=prev><link href=../oexpl_runtime_data_structures/virtual_function_table/ rel=next><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.31"><title>OExpL Runtime Data Structures - EXPL NIT-C</title><link rel=stylesheet href=../assets/stylesheets/main.3cba04c6.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=purple data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#runtime-data-structures-for-oexpl class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <b>Site is undergoing migration.</b> Old URL: <a href=https://silcnitc.github.io target=_blank target=_blank rel="nofollow noopener">https://silcnitc.github.io</a> </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="EXPL NIT-C" class="md-header__button md-logo" aria-label="EXPL NIT-C" data-md-component=logo> <img src=../img/nitc-logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> EXPL NIT-C </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> OExpL Runtime Data Structures </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=purple data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=purple data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../about/philosophy/ class=md-tabs__link> About </a> </li> <li class=md-tabs__item> <a href=../roadmap/ class=md-tabs__link> Roadmap </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../documentation/ class=md-tabs__link> Documentation </a> </li> <li class=md-tabs__item> <a href=../feedback/ class=md-tabs__link> Student Feedback </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="EXPL NIT-C" class="md-nav__button md-logo" aria-label="EXPL NIT-C" data-md-component=logo> <img src=../img/nitc-logo.png alt=logo> </a> EXPL NIT-C </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> About </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../about/philosophy/ class=md-nav__link> <span class=md-ellipsis> Philosophy </span> </a> </li> <li class=md-nav__item> <a href=../about/authors/ class=md-nav__link> <span class=md-ellipsis> Authors </span> </a> </li> <li class=md-nav__item> <a href=../about/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Roadmap </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Roadmap </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../roadmap/ class=md-nav__link> <span class=md-ellipsis> Roadmap </span> </a> </li> <li class=md-nav__item> <a href=../roadmap/stage-00/ class=md-nav__link> <span class=md-ellipsis> Stage 0 </span> </a> </li> <li class=md-nav__item> <a href=../roadmap/stage-01/ class=md-nav__link> <span class=md-ellipsis> Stage 1 </span> </a> </li> <li class=md-nav__item> <a href=../roadmap/stage-02/ class=md-nav__link> <span class=md-ellipsis> Stage 2 </span> </a> </li> <li class=md-nav__item> <a href=../roadmap/stage-03/ class=md-nav__link> <span class=md-ellipsis> Stage 3 </span> </a> </li> <li class=md-nav__item> <a href=../roadmap/stage-04/ class=md-nav__link> <span class=md-ellipsis> Stage 4 </span> </a> </li> <li class=md-nav__item> <a href=../roadmap/stage-05/ class=md-nav__link> <span class=md-ellipsis> Stage 5 </span> </a> </li> <li class=md-nav__item> <a href=../roadmap/stage-06/ class=md-nav__link> <span class=md-ellipsis> Stage 6 </span> </a> </li> <li class=md-nav__item> <a href=../roadmap/stage-07/ class=md-nav__link> <span class=md-ellipsis> Stage 7 </span> </a> </li> <li class=md-nav__item> <a href=../roadmap/stage-08/ class=md-nav__link> <span class=md-ellipsis> Stage 8 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Documentation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../documentation/ class=md-nav__link> <span class=md-ellipsis> Documentation </span> </a> </li> <li class=md-nav__item> <a href=../codegen/ class=md-nav__link> <span class=md-ellipsis> Code Generation </span> </a> </li> <li class=md-nav__item> <a href=../abi/ class=md-nav__link> <span class=md-ellipsis> Application Binary Interface </span> </a> </li> <li class=md-nav__item> <a href=../libinterface/ class=md-nav__link> <span class=md-ellipsis> Library Implementation </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5 id=__nav_4_5_label tabindex> <span class=md-ellipsis> ExPL </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> ExPL </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../expl/ class=md-nav__link> <span class=md-ellipsis> ExpL Specification </span> </a> </li> <li class=md-nav__item> <a href=../grammar-outline/ class=md-nav__link> <span class=md-ellipsis> ExpL Grammar Outline </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5_3> <label class=md-nav__link for=__nav_4_5_3 id=__nav_4_5_3_label tabindex=0> <span class=md-ellipsis> Compile Time Data Structures for ExpL </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5_3> <span class="md-nav__icon md-icon"></span> Compile Time Data Structures for ExpL </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../data-structures/ class=md-nav__link> <span class=md-ellipsis> Compile Time Data Structures for ExpL </span> </a> </li> <li class=md-nav__item> <a href=../data_structures/abstract-syntax-tree/ class=md-nav__link> <span class=md-ellipsis> Abstract Syntax Tree </span> </a> </li> <li class=md-nav__item> <a href=../data_structures/type-table/ class=md-nav__link> <span class=md-ellipsis> Type Table </span> </a> </li> <li class=md-nav__item> <a href=../data_structures/global-symbol-table/ class=md-nav__link> <span class=md-ellipsis> Global Symbol Table </span> </a> </li> <li class=md-nav__item> <a href=../data_structures/local-symbol-table/ class=md-nav__link> <span class=md-ellipsis> Local Symbol Table </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5_4> <label class=md-nav__link for=__nav_4_5_4 id=__nav_4_5_4_label tabindex=0> <span class=md-ellipsis> Run Time Data Structures for ExpL </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5_4> <span class="md-nav__icon md-icon"></span> Run Time Data Structures for ExpL </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../run-data-structures/ class=md-nav__link> <span class=md-ellipsis> Run Time Data Structures for ExpL </span> </a> </li> <li class=md-nav__item> <a href=../run_data_structures/heap/ class=md-nav__link> <span class=md-ellipsis> Heap Allocation </span> </a> </li> <li class=md-nav__item> <a href=../run_data_structures/register/ class=md-nav__link> <span class=md-ellipsis> Register Allocation </span> </a> </li> <li class=md-nav__item> <a href=../run_data_structures/run-time-stack/ class=md-nav__link> <span class=md-ellipsis> Stack Allocation </span> </a> </li> <li class=md-nav__item> <a href=../run_data_structures/static-allocation/ class=md-nav__link> <span class=md-ellipsis> Static Allocation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5_5> <label class=md-nav__link for=__nav_4_5_5 id=__nav_4_5_5_label tabindex=0> <span class=md-ellipsis> ExPL Test Programs </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5_5> <span class="md-nav__icon md-icon"></span> ExPL Test Programs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../testprograms/ class=md-nav__link> <span class=md-ellipsis> Test Programs </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-01/ class=md-nav__link> <span class=md-ellipsis> Program 1 </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-02/ class=md-nav__link> <span class=md-ellipsis> Program 2 </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-03/ class=md-nav__link> <span class=md-ellipsis> Program 3 </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-04/ class=md-nav__link> <span class=md-ellipsis> Program 4 </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-05/ class=md-nav__link> <span class=md-ellipsis> Program 5 </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-06/ class=md-nav__link> <span class=md-ellipsis> Program 6 </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-07/ class=md-nav__link> <span class=md-ellipsis> Program 7 </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-08/ class=md-nav__link> <span class=md-ellipsis> Program 8 </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-09/ class=md-nav__link> <span class=md-ellipsis> Program 9 </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-10/ class=md-nav__link> <span class=md-ellipsis> Program 10 </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-11/ class=md-nav__link> <span class=md-ellipsis> Program 11 </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/test-program-12/ class=md-nav__link> <span class=md-ellipsis> Program 12 </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_5_5_14> <label class=md-nav__link for=__nav_4_5_5_14 id=__nav_4_5_5_14_label tabindex=0> <span class=md-ellipsis> Stage 4 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_4_5_5_14_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5_5_14> <span class="md-nav__icon md-icon"></span> Stage 4 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../testprograms/stage4/bubblesort/ class=md-nav__link> <span class=md-ellipsis> Bubble Sort </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/stage4/fibaofn/ class=md-nav__link> <span class=md-ellipsis> Fibonacci </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/stage4/prime/ class=md-nav__link> <span class=md-ellipsis> Prime </span> </a> </li> <li class=md-nav__item> <a href=../testprograms/stage4/sum-to-n-fact/ class=md-nav__link> <span class=md-ellipsis> Sum to n! </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_6 checked> <label class=md-nav__link for=__nav_4_6 id=__nav_4_6_label tabindex> <span class=md-ellipsis> OExpL </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_6_label aria-expanded=true> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> OExpL </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../oexpl-specification/ class=md-nav__link> <span class=md-ellipsis> OExpL Specification </span> </a> </li> <li class=md-nav__item> <a href=../oexpl-grammar-outline/ class=md-nav__link> <span class=md-ellipsis> OExpL Grammar Outline </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_6_3> <label class=md-nav__link for=__nav_4_6_3 id=__nav_4_6_3_label tabindex=0> <span class=md-ellipsis> Compile Time Data Structures for OExpL </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6_3> <span class="md-nav__icon md-icon"></span> Compile Time Data Structures for OExpL </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../oexpl-data-structures/ class=md-nav__link> <span class=md-ellipsis> Compile Time Data Structures for OExpL </span> </a> </li> <li class=md-nav__item> <a href=../oexpl_data_structures/class-table/ class=md-nav__link> <span class=md-ellipsis> Class Table </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_6_4 checked> <label class=md-nav__link for=__nav_4_6_4 id=__nav_4_6_4_label tabindex=0> <span class=md-ellipsis> Run Time Data Structures for OExpL </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_6_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4_6_4> <span class="md-nav__icon md-icon"></span> Run Time Data Structures for OExpL </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Run Time Data Structures for OExpL </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Run Time Data Structures for OExpL </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#virtual-function-table class=md-nav__link> <span class=md-ellipsis> Virtual Function Table </span> </a> <nav class=md-nav aria-label="Virtual Function Table"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#illustration class=md-nav__link> <span class=md-ellipsis> Illustration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#runtime-binding class=md-nav__link> <span class=md-ellipsis> Runtime Binding </span> </a> </li> <li class=md-nav__item> <a href=#method-invocations class=md-nav__link> <span class=md-ellipsis> Method Invocations </span> </a> </li> <li class=md-nav__item> <a href=#run-time-stack-management-for-method-invocations class=md-nav__link> <span class=md-ellipsis> Run time Stack Management for Method invocations </span> </a> <nav class=md-nav aria-label="Run time Stack Management for Method invocations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-do-we-need-to-push-the-object-illustration class=md-nav__link> <span class=md-ellipsis> Why do we need to push the object? Illustration </span> </a> </li> <li class=md-nav__item> <a href=#use-of-self-for-member-field-access class=md-nav__link> <span class=md-ellipsis> Use of self for member field access </span> </a> </li> <li class=md-nav__item> <a href=#use-of-self-for-method-invocations class=md-nav__link> <span class=md-ellipsis> Use of self for method invocations </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../oexpl_runtime_data_structures/virtual_function_table/ class=md-nav__link> <span class=md-ellipsis> Virtual Function Table </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../oexpl-runtime-binding-tutorial/ class=md-nav__link> <span class=md-ellipsis> OExPL Runtime Binding </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_6_6> <label class=md-nav__link for=__nav_4_6_6 id=__nav_4_6_6_label tabindex=0> <span class=md-ellipsis> OExPL Test Programs </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_6_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6_6> <span class="md-nav__icon md-icon"></span> OExPL Test Programs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../oexpl-testprograms/ class=md-nav__link> <span class=md-ellipsis> OExPL Test Programs </span> </a> </li> <li class=md-nav__item> <a href=../oexpltestprograms/test1/ class=md-nav__link> <span class=md-ellipsis> Program 1 </span> </a> </li> <li class=md-nav__item> <a href=../oexpltestprograms/test2/ class=md-nav__link> <span class=md-ellipsis> Program 2 </span> </a> </li> <li class=md-nav__item> <a href=../oexpltestprograms/test3/ class=md-nav__link> <span class=md-ellipsis> Program 3 </span> </a> </li> <li class=md-nav__item> <a href=../oexpltestprograms/test4/ class=md-nav__link> <span class=md-ellipsis> Program 4 </span> </a> </li> <li class=md-nav__item> <a href=../oexpltestprograms/test5/ class=md-nav__link> <span class=md-ellipsis> Program 5 </span> </a> </li> <li class=md-nav__item> <a href=../oexpltestprograms/test6/ class=md-nav__link> <span class=md-ellipsis> Program 6 </span> </a> </li> <li class=md-nav__item> <a href=../oexpltestprograms/test7/ class=md-nav__link> <span class=md-ellipsis> Program 7 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_7> <label class=md-nav__link for=__nav_4_7 id=__nav_4_7_label tabindex> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_7_label aria-expanded=false> <label class=md-nav__title for=__nav_4_7> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../lex/ class=md-nav__link> <span class=md-ellipsis> Using LEX </span> </a> </li> <li class=md-nav__item> <a href=../yacc/ class=md-nav__link> <span class=md-ellipsis> Using YACC </span> </a> </li> <li class=md-nav__item> <a href=../ywl/ class=md-nav__link> <span class=md-ellipsis> Using YACC with LEX </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_7_4> <label class=md-nav__link for=__nav_4_7_4 id=__nav_4_7_4_label tabindex=0> <span class=md-ellipsis> GDB </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_7_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_7_4> <span class="md-nav__icon md-icon"></span> GDB </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../gdb/ class=md-nav__link> <span class=md-ellipsis> Using GDB </span> </a> </li> <li class=md-nav__item> <a href=../gdb-files/ class=md-nav__link> <span class=md-ellipsis> GDB Input Files </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../label-translation/ class=md-nav__link> <span class=md-ellipsis> Label Translation </span> </a> </li> <li class=md-nav__item> <a href=../install/ class=md-nav__link> <span class=md-ellipsis> XSM Simulator Installation </span> </a> </li> <li class=md-nav__item> <a href=../xsmusagespec/ class=md-nav__link> <span class=md-ellipsis> XSM Simulator Instructions </span> </a> </li> <li class=md-nav__item> <a href=../xsm-environment-tut/ class=md-nav__link> <span class=md-ellipsis> XSM Environment Tutorial </span> </a> </li> <li class=md-nav__item> <a href=../library-implementation/ class=md-nav__link> <span class=md-ellipsis> Library Implementation </span> </a> </li> <li class=md-nav__item> <a href=../attribute/ class=md-nav__link> <span class=md-ellipsis> Attribute Synthesis </span> </a> </li> <li class=md-nav__item> <a href=../Data_Structures/ class=md-nav__link> <span class=md-ellipsis> Data Structures for ExpL Compilation/Interpretation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_8> <label class=md-nav__link for=__nav_4_8 id=__nav_4_8_label tabindex> <span class=md-ellipsis> Misc </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_8_label aria-expanded=false> <label class=md-nav__title for=__nav_4_8> <span class="md-nav__icon md-icon"></span> Misc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ex1/ class=md-nav__link> <span class=md-ellipsis> Exercise 1 </span> </a> </li> <li class=md-nav__item> <a href=../explusagespec/ class=md-nav__link> <span class=md-ellipsis> ExPL Usage spec? </span> </a> </li> <li class=md-nav__item> <a href=../libinterfaceexpl/ class=md-nav__link> <span class=md-ellipsis> ExPL Library Interface? </span> </a> </li> <li class=md-nav__item> <a href=../help/ class=md-nav__link> <span class=md-ellipsis> help </span> </a> </li> <li class=md-nav__item> <a href=../oexpl/ class=md-nav__link> <span class=md-ellipsis> OExPL </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Student Feedback </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Student Feedback </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../feedback/ class=md-nav__link> <span class=md-ellipsis> Student Feedback </span> </a> </li> <li class=md-nav__item> <a href=../feedback/nitc-winter-2021/ class=md-nav__link> <span class=md-ellipsis> NIT-C Winter 2021 </span> </a> </li> <li class=md-nav__item> <a href=../feedback/nitc-winter-2017/ class=md-nav__link> <span class=md-ellipsis> NIT-C Winter 2017 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#virtual-function-table class=md-nav__link> <span class=md-ellipsis> Virtual Function Table </span> </a> <nav class=md-nav aria-label="Virtual Function Table"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#illustration class=md-nav__link> <span class=md-ellipsis> Illustration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#runtime-binding class=md-nav__link> <span class=md-ellipsis> Runtime Binding </span> </a> </li> <li class=md-nav__item> <a href=#method-invocations class=md-nav__link> <span class=md-ellipsis> Method Invocations </span> </a> </li> <li class=md-nav__item> <a href=#run-time-stack-management-for-method-invocations class=md-nav__link> <span class=md-ellipsis> Run time Stack Management for Method invocations </span> </a> <nav class=md-nav aria-label="Run time Stack Management for Method invocations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-do-we-need-to-push-the-object-illustration class=md-nav__link> <span class=md-ellipsis> Why do we need to push the object? Illustration </span> </a> </li> <li class=md-nav__item> <a href=#use-of-self-for-member-field-access class=md-nav__link> <span class=md-ellipsis> Use of self for member field access </span> </a> </li> <li class=md-nav__item> <a href=#use-of-self-for-method-invocations class=md-nav__link> <span class=md-ellipsis> Use of self for method invocations </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=runtime-data-structures-for-oexpl>Runtime Data Structures for OExpL<a class=headerlink href=#runtime-data-structures-for-oexpl title="Permanent link">&para;</a></h1> <h2 id=virtual-function-table>Virtual Function Table<a class=headerlink href=#virtual-function-table title="Permanent link">&para;</a></h2> <p><strong>Virtual Function Table</strong> is a run time data structure that is used to resolve at run time the call addresses of methods in a class. Such mechanism (or other table schemes) needs to be implemented by compilers for languages that support <a href=https://en.wikipedia.org/wiki/Inheritance_(object-oriented_programming)>inheritance</a>, <a href=https://en.wikipedia.org/wiki/Subtyping>subtype Polymorphism</a> and <a href=https://en.wikipedia.org/wiki/Method_overriding>method over-riding</a>. A run time virtual function table is maintained in the memory for each class. <strong>The compiler generates code to initialize the table for each class such that each function that can be invoked from the class has an entry in the table</strong>. For each function defined or inherited by a class, the table will contain the call address of the function in the code region of memory. <strong>If a function is inherited by a class from its parent and is not over-ridden by the class, the call address stored will be that of the function defined in the parent class</strong>. The same address will be stored for the function in the virtual function table of the parent class as well.</p> <p>The OExpL compiler maintains a virtual function table of eight words for each class. Hence, a class can have at most eight member functions. The i-th entry in the table holds the address of the i-th function of the class (identified by the field <strong>Funcposition</strong> in the <a href=../oexpl-data-structures/ >class table</a> - see Memberfunclist). While generating code, <strong>if there is a call to a function within a class, the compiler simply translates the call to "CALL [address]", where address is obtained from the corresponding virtual function table</strong>.</p> <p>A simple way to place the virtual function table is to use the initial part of the stack region (starting at memory address 4096), ahead of global variables. This is suggested because the compilation of classes will be finished before compiling the global declarations. In this scheme, the virtual function table of the class defined first in the program will be stored in the region 4096-4103, the second in 4104-4111 and so on.</p> <p>When the compiler encounters the declaration of a variable of a class, it allocates <strong>two words of storage</strong> for the variable (unlike other variables, where only one word of storage is allocated). The first word is used to store the address of the memory area allocated in the heap for the class (eight words). Space for member fields is allocated in the heap exactly as done with user defined types. We will call this word the <strong>member field pointer</strong>. <strong>The second word is used to store the address of virtual function table</strong>. We will call this word the <strong>virtual function table pointer</strong>.</p> <p><strong>The key point to note here is that the virtual function pointer of a variable need not always point to the virtual function table of the class of the variable. This is because a variable of a parent class can hold a reference to an object of any of its descendant classes. In such cases, the virtual function pointer will hold the address of the descendant class.</strong></p> <p>Hence, an assignment of a variable (of one class) to another variable (of the same class or an ancestor class) results in transfer of the contents of both the pointers of one variable to the corresponding pointers of the other. The <em>new</em> function sets the virtual function table pointer to the address of the virtual function table of the class specified as the argument to the new function. A little bit of thought is necessary to reveal that this implementation will yield the correct execution semantics.</p> <p>A detailed illustration follows.</p> <h3 id=illustration>Illustration<a class=headerlink href=#illustration title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>class
A
{
  decl
    int f0();
    int f1();
  enddecl
  int f0() {                   /*Newly defined method*/
      begin
       write(&quot;In class A f0&quot;);
       return 1;
      end
  }
  int f1() {                   /*Newly defined method*/
      begin
        write(&quot;In class A f1&quot;);
        return 1;
      end
  }
}                       /*End of Class Definition A*/
B extends A
{
  decl
    int f0();
    int f2();
  enddecl
int f0() {                    /*f0 of class A is overridden by this method */
     begin
       write(&quot;In class B f0&quot;);
       return 1;
     end
}
int f2() {                    /*Newly defined method*/
     begin
       write(&quot;In class B f2&quot;);
       return 1;
     end
}
/* Class B inherits f1 from Class A */

}                       /*End of Class Definition B*/
C extends B
{
  decl
    int f0();
    int f2();
    int f4();
  enddecl
int f0() {                /*f0 of Class B is overridden by this method*/
     begin
       write(&quot;In class C f0&quot;);
       return 1;
     end
}
int f2() {                /*f2 of Class B is overridden by this method */
    begin
       write(&quot;In class C f2&quot;);
       return 1;
    end
}
int f4() {                /*Newly defined method*/
    begin
       write(&quot;In class C f4&quot;);
       return 1;
    end
}

/*Class C inherits f1 from Class A */

}                        /*End of Class Definition C*/
endclass
</code></pre></div> <ol> <li> <p>Storage for virtual function tables start at 4096 in the stack. Eight consecutive words are allocated for storing the virtual function table of each class. Each word of virtual function table stores the call address of the corresponding function in the class. Thus, a class can contain atmost eight methods. Virtual function tables of various classes are stored in the order in which the classes are declared in the program. As noted earlier, we will allocate the space for global declarations after virtual function tables are allocated.</p> <p>By using the <em>Class_index</em> field of the <a href=../oexpl-data-structures/ >class_table</a> entry, the starting address of the virtual function table for that particular class can be computed using the formula <strong>4096 + (Class_index * 8)</strong>. The class defined first will have <em>Class_index</em> zero, the next will have one and so on.</p> </li> <li> <p><strong>When the declaration of each method is found (in a class) a new label is generated for the function and the label is stored in the <a href=../oexpl-data-structures/ >class table entry</a></strong> (See <em>Memberfunclist</em> ) <strong>for the function at compile time.</strong> The compiler also must generate code to store these labels into the virtual function table entry of the function in the corresponding class. (Strictly speaking, an integer value called the "pseudo-address" for the function is stored in the <em>flabel</em> field of the <em>Memberfunclist</em> entry of the function. The pseudo addresses could be 0,1,2,3 and so on. When code is generated, for functions with <em>flabel</em> values 0,1,2,3, etc., the actual labels placed could be F0,F1,F2,F3 etc to make them more human readable.)</p> </li> <li> <p><strong>It is better to maintain the index of a method in the <a href=../oexpl-data-structures/ >class table</a> (Funcposition) and the virtual function table to be the same.</strong> This makes code generation for method invocations easier. When a method is invoked, the compiler can look up the index of the method from the appropriate class table and generate code to invoke the function whose call address (label) is stored in the virtual function table at the position determined by index.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>that the class table is a static (compile time) data structure and will not be part of the target program. The compiler uses the class table information to generate code that will create the virtual function table at execution (run) time.</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>It is sufficient to place labels, and not addresses in the virtual function table, as the <a href=../label-translation/ >label translation phase</a> will take care of translating labels to addresses</p> </div> <p>In the example given, the function f0 in class A has funcposition 0 and say flabel F0 (we identify flabel 0 with F0) and the function f1 in class A gets a funcposition 1 and say flabel F1 (we identify flabel 1 with F1). The member function list of class A looks as shown in the below figure :</p> <p><img alt src=../img/virtual_function_table_3.png></p> <p>The virtual function table of class A looks as shown in the figure below. It is constructed using member function list of class A which is shown in the figure above.</p> <p><img alt src=../img/virtual_function_table_1.png></p> <p>As mentioned earlier, all the labels of the functions will be replaced with addresses during <a href=../label-translation/ >label translation phase</a>.</p> </li> <li> <p>Class B extends class A and over-rides f0(). Further, class B contains the newly defined method f2(). When a class extends another, all the member fields and methods of the parent class are inherited by the derived class, unless over-ridden by a new definition. Since the method f0() is over-ridden by B, a new label will have to be allocated for the function f0() in class B. In the present example, we set the new label to F2. Accordingly, the compiler must update <em>Memberfunclist</em> entry of the method f0() in class B with the new <em>flabel</em> value. Correspondingly, in the virtual function table entry for class B, the entry for method f0() must be F2 (over-riding F0). The entry for method f1() (label F1) will be inherited from class A. A new label (label F3 in the example) must be generated for the function f2() defined in class B. The labels for each method in class B is shown in the table below for easy reference.</p> <p><img alt src=../img/virtual_function_table_8.png></p> <p>From an implementation point of view, it will be easier to (generate code to) copy all the virtual function table entries of A to the virtual function table of B and then (generate code to) modify the labels of over-ridden functions/add labels for new functions defined in B. The compilation for class C may proceed similarly. Note that OExpL specification stipulates that the signatures of the over-ridden methods must match exactly with the signature of the original definition in the parent class.</p> <p><img alt src=../img/virtual_function_table_4.png></p> <p>★ Overridden labels are marked in red</p> <p>The corresponding virtual function tables of all the classes are shown in the figure given below :</p> <p><img alt src=../img/virtual_function_table_2.png></p> <p>★ Overridden labels are marked in red</p> </li> </ol> <h2 id=runtime-binding>Runtime Binding<a class=headerlink href=#runtime-binding title="Permanent link">&para;</a></h2> <p>Please go through the <a href=../oexpl-specification/#nav-run-time-binding>OExpL Specification - Run time Binding</a> carefully before proceeding further.</p> <p>Consider the OExpL code given below assuming the classes defined <a href=./#nav-illustration>above</a></p> <p><div class=highlight><pre><span></span><code>decl
    A obj ;
enddecl

int main() {
  decl
    int temp,n;
  enddecl
  begin
    temp= initialize();
    read(n);
    if(n &lt; 0)then
        obj = new(A);
    else
        if(n == 0)then
            obj = new(B);
        else
            if(n &gt; 0)then
                obj = new(C);
            endif;
       endif;
    endif;
   write(obj.f0());             /* Have a careful look at this call */
    return 1;
  end
}
</code></pre></div> The method invocation within the statement obj.f0() in the above code needs to be analysed carefully. Depending on the run time value of n, the actual function to be invoked will be different. <strong>This is because the variable obj will be bound to different classes depending on the value of n</strong>. Here we describe what the compiler must do to bind obj to the correct class at run time.</p> <p>We have already noted earlier that, when the compiler encounters the declaration of a variable of a class, it has to allocate <strong>two words of storage</strong> for the variable (unlike other variables, where only one word of storage is allocated). The first word ( <strong>member field pointer</strong> ) is to store the address of the memory area allocated in the heap for the class (eight words). The compiler must use the second word ( <strong>virtual function table pointer</strong> ) to store the address of the virtual function table of the class to which the variable is bound to at run time.</p> <p>For instance, the statement <em>obj = new(A);</em> must result in two actions:</p> <ol> <li>The member field pointer of <em>obj</em> must be set to a newly allocated heap block.</li> <li>The virtual function table pointer of <em>obj</em> must be set to the start address of the virtual function table of class A.</li> </ol> <p>Recall that the start address of the virtual function table for a class can be computed as (4096 + <em>class_index</em> * 8). In the above example, since the <em>class_index</em> of class A is zero, the above statement sets the virtual function table pointer value of obj to the value 4096.</p> <p>Similarly the statement obj=new(B) results in the compiler generating code to store the value 4104 to the virtual function table pointer of the variable obj. obj=new(C) would result in storing the value 4112 to the virtual function table pointer of obj. As an illustration, assume that the compiler has allocated memory address 4120 and 4121 for storing the member field pointer and virtual function table pointer of obj. Assume that a call to the new function results in allocation of 8 words in the heap starting with the memory address 1024 (using the <a href=../run_data_structures/heap/ >Alloc()</a> library function). The following figure shows how the values of memory locations 4120 and 4121 has to be set for various values of n.</p> <p>if '( n &lt; 0)' then the two words of obj is :</p> <p><img alt src=../img/virtual_function_table_5.png></p> <p>if '(n = 0)' then the two words of obj is :</p> <p><img alt src=../img/virtual_function_table_6.png></p> <p>if '(n &gt; 0)' then the two words of obj is :</p> <p><img alt src=../img/virtual_function_table_7.png></p> <p>In the above code, the value of n is read from the console and is not known at the compile time. Hence, the actual value stored in the virtual function table pointer of obj during run-time cannot be predicted at compile time. Consequently, the actual function invoked by the call obj.f0() cannot be predicted at compile time. This fact forces the compiler to generate code to maintain the virtual function tables at run time.</p> <p>Note that an assignment statement would result in copying the values of both the pointers of the variable on the right side to the variable on the left side.**</p> <h2 id=method-invocations>Method Invocations<a class=headerlink href=#method-invocations title="Permanent link">&para;</a></h2> <p>Consider the statement <strong>write(obj.f0());</strong> in the above code. The compiler can resolve the call <em>obj.f0();</em> by generating code to:</p> <ol> <li>Use the virtual function table pointer field of <em>obj</em> to find the address of the virtual function table of the class to which obj is bound to.</li> <li>Look up the virtual function table to find the address (label) of the function f0().</li> <li>Call the function (of course, after setting up the call stack).</li> </ol> <p>When compiler encounters the method invocation, <strong>obj.f0()</strong>, it first checks the type of <em>obj</em> - i.e, to which class the <strong>obj</strong> belongs to. Then it gets the member function list of the class of that object and checks if there is any method with name <strong>f0</strong>. If it finds a method, it proceeds with the compilation. Otherwise, a compilation error is reported.</p> <p>In more detail, for the call <em>obj.f0()</em>, the compiler must do the following:</p> <ol> <li>Find the index of <em>f0()</em> in the <a href=../oexpl-data-structures/ >class table</a> entry of <em>obj</em>. Here <em>obj</em> is declared to be of class A and the index (look up Funcposition field in the member function list of class A) of <em>f0()</em> in class A will be 0.</li> <li>Generate the code to push the registers in use into the stack</li> <li>Generate the code to move to a register (say R0) the label of the function at index 0 from the virtual function table of <em>obj</em>. The virtual function table pointer field of obj will point to the virtual function table.</li> <li>Generate code to push the "self object" into the stack as argument (i.e., the member field pointer of obj and the virtual function table pointer of obj must be pushed as arguments to the call to f0() - See Run time Stack Management for Method Invocations below .)</li> <li>Generate code to call the function using the label obtained in step 2. (call R0).</li> <li>Generate code to unwind the stack, extract return values upon return from the call and restore registers.</li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p>The OExpL specification requires that a class can have only a single method of a given name, and the signature of a method inherited from a parent class (over-ridden or otherwise) must be identical with the signature of the method in the parent class. These simplifications allow the above implementation of virtual function tables where, the index of a method in the virtual function tables of every class in a class hierarchy is unique. If method overloading was supported, then there would be multiple functions with the same name within a class, and the implementation would be slightly more involved. (Think what additional stuff needs to be done in that case!)</p> </div> <h2 id=run-time-stack-management-for-method-invocations>Run time Stack Management for Method invocations<a class=headerlink href=#run-time-stack-management-for-method-invocations title="Permanent link">&para;</a></h2> <p>While generating the code for invoking a method of a class using an object of the class (for example, in the call obj.f0() above, f0() is invoked using the object obj of class A) <strong>the member field pointer and virtual function table pointer of the object must be pushed to the stack in addition to normal arguments of the function.</strong> We will follow the convention that these two values will be pushed before other arguments are pushed. This is how the runtime stack looks, when a method of a class is <strong>called</strong>.</p> <p><img alt src=../img/rts11.png></p> <p>For instance, in the above <a href=./#nav-runtimebinding>example</a>, The value of <em>n</em> read from the input is 0, the following figure shows the run time stack. Note that the function f0 has no arguments.</p> <p><img alt src=../img/rts2.png></p> <h3 id=why-do-we-need-to-push-the-object-illustration>Why do we need to push the object? Illustration<a class=headerlink href=#why-do-we-need-to-push-the-object-illustration title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>class
A
{
  decl
      int i;
      int f0();
      int f1();
  enddecl

  int f0() {
    decl
        int c;
    enddecl
    begin
        c = self.f1();    // call to f1() from f0()
        write(self.i);
        return 1;
    end
  }
  int f1() {
      decl
      enddecl
      begin
          self.i=0;
          write(&quot;In A F1&quot;);        // This is printed when f1() is invoked from an object of class A
          return 1;
      end
  }
}
B extends A
{
  decl
     int f1();      // B overrides f1
  enddecl

  int f1() {
        decl
        enddecl
        begin
            self.i=1;
            write(&quot;In B F1&quot;);   // This is printed when f1() is invoked from an object of class B
            return 1;
        end
  }
}
endclass

decl
  int n;
  A obj;
enddecl

int main() {
  decl
  enddecl
  begin
      read(n);
      if(n&gt;0) then
        obj = new(A);
      else
        obj = new(B);
       endif;
        n = obj.f0();     // f0() contains a call to f1(). f1() is overriden by class B
        return 1;
  end
}
</code></pre></div> <p>According to OExpL Specification, a member field or method should be accessed using <em>self</em>. In order to correctly specify the object referred to <em>self</em>, we need to push the object (member field pointer and virtual function pointer) into the stack.</p> <p>Consider the following OExpL program,</p> <h3 id=use-of-self-for-member-field-access>Use of self for member field access<a class=headerlink href=#use-of-self-for-member-field-access title="Permanent link">&para;</a></h3> <p>Consider the statement self.i = 0 or self.i = 1 . We need to store the value 0 or 1 for the member field i, of the object represented by the <em>self</em> (calling object). In order to identify the object's heap address, the <strong>member field pointer</strong> of the <em>obj</em> must be available as an argument in the stack.</p> <h3 id=use-of-self-for-method-invocations>Use of self for method invocations<a class=headerlink href=#use-of-self-for-method-invocations title="Permanent link">&para;</a></h3> <p>Suppose n &gt; 0, then the variable <em>obj</em> will be bound to an object of class A. If n &lt;= 0, then the variable <em>obj</em> will be bound to an object of class B.</p> <p>When the compiler encounters the method invocation <em>obj.f0()</em>, the virtual function table of <em>obj</em> will be looked up to find the call address of the method f0(). Since f0() is defined in class A and not over-ridden by class B, the virtual function tables of both class A and class B will store the same call address for f0().</p> <p>However, inside the method f0(), there is a call to the method <em>self.f1()</em>. Note that f1() is over-ridden by class B. Hence, the <strong>call address for the method f1() when <em>obj</em> holds an object of class A will be different from the call address of f1() when <em>obj</em> holds an object of class B. However, the class corresponding to the object stored in <em>obj</em> is determined by the value of n which is not known at compile time.</strong> Hence, to generate code for the call <em>obj.f1()</em> inside f0(), the virtual function table of the class to which <em>self</em> is associated must be available as an argument in the stack. Inside f0(), when the compiler translates the call <em>self.f1()</em>, it needs to do the following:</p> <ol> <li>Generate code to look up the <strong>virtual function table field</strong> of <em>self</em> (received as argument) to find the call address of the function f1().</li> <li>Generate code to invoke f1() using the address obtained (of course, after setting up the call stack).</li> </ol> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> <a href=https://creativecommons.org/licenses/by-nc/4.0/ rel=license> <img alt="Creative Commons License" style=border-width:0 src=https://licensebuttons.net/l/by-nc/4.0/80x15.png> </a> National Insititute of Technology, Calicut </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/silcnitc target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://groups.google.com/g/expl-users target=_blank rel=noopener title=groups.google.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 488 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.tabs", "navigation.top", "navigation.sections"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.fe8b6f2b.min.js></script> </body> </html>